#!/bin/bash

set -o errexit
set -o pipefail
set -o nounset

SCRIPT_PATH=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )
BASE_PATH=$( cd -- "$( dirname -- "${SCRIPT_PATH}" )" &> /dev/null && pwd )

BASE_IMAGE="${BASE_IMAGE:-mcr.microsoft.com/devcontainers/base:ubuntu}"

PARAM_FEATURES=

if [ $# -gt 0 ]; then
    PARAM_FEATURES="--features $@"
fi

cd $BASE_PATH

devcontainer features test --skip-autogenerated --skip-duplicated $PARAM_FEATURES --project-folder $BASE_PATH
